<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>Troll Campfire</title>
<style>
  html,body{margin:0;background:#000;overflow:hidden}
  canvas{display:block;width:100vw;height:100vh;image-rendering:pixelated;image-rendering:crisp-edges}
  #hint{
    position:fixed;left:0;right:0;bottom:12px;text-align:center;
    color:#cfcfcf;font:12px/1.2 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial;
    opacity:.7;pointer-events:none;
  }
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="hint">화면을 한 번 터치하면 불꽃 소리가 시작됩니다</div>

<script>
(() => {
  // ============================================================
  // 0) 원본 그림을 "파일 없이" 코드로 내장 (Base64 JPEG)
  //    - 아래 IMG_DATA는 네가 준 원본을 축소(420px)해 내장한 것
  // ============================================================
  const IMG_DATA = `data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7
Ojo6Iys/RD84QzQ5Ojo6/2wBDAQoLCw4NDh0QEB04KCIoODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4
ODg4ODg4ODg4/3QAEAAf/2gAMAwEAAhEDEQA/APf+iiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK
KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAC
iiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAo
ooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKK
KACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiii
gAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA
KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAoooo
AKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACi
iigAooooA//Z`;
  // 위 Base64 문자열 줄바꿈이 들어가 있어도 브라우저가 처리하지만,
  // 혹시 문제 생기면 줄바꿈 제거해도 됨.

  // ============================================================
  // 1) 캔버스/이미지 준비
  // ============================================================
  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d', { alpha:false });
  ctx.imageSmoothingEnabled = false;

  const img = new Image();
  img.decoding = "async";
  img.src = IMG_DATA;

  // 화면/이미지 contain 사각형 계산
  function containRect(imgW, imgH, boxW, boxH){
    const imgAR = imgW / imgH;
    const boxAR = boxW / boxH;
    let w, h, x, y;
    if (imgAR > boxAR) { w = boxW; h = boxW / imgAR; x = 0; y = (boxH - h) / 2; }
    else { h = boxH; w = boxH * imgAR; y = 0; x = (boxW - w) / 2; }
    return {x, y, w, h};
  }

  function resize(){
    const dpr = devicePixelRatio || 1;
    canvas.width  = Math.floor(innerWidth * dpr);
    canvas.height = Math.floor(innerHeight * dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);
    ctx.imageSmoothingEnabled = false;
  }
  addEventListener('resize', resize);
  resize();

  // ============================================================
  // 2) 불꽃 애니메이션 (원본 위에만 오버레이)
  //    - 불꽃 위치는 원본 분석 기반으로 자동 잡아둠
  //      (x≈0.744, y≈0.818 : 원본 이미지 내 비율)
  // ============================================================
  const FIRE_U = 0.744;
  const FIRE_V = 0.818;

  const sparks = [];
  function spawnSpark(fx, fy){
    sparks.push({
      x: fx + (Math.random()-0.5)*14,
      y: fy + (Math.random()-0.5)*6,
      vx:(Math.random()-0.5)*0.4,
      vy:-0.8 - Math.random()*0.9,
      life: 1
    });
  }

  function drawFireOverlay(rect, time){
    // rect: 화면에서 이미지가 실제로 보이는 영역
    const fx = rect.x + rect.w * FIRE_U;
    const fy = rect.y + rect.h * FIRE_V;

    // 불꽃 바디
    const flick = 0.55 + 0.45*Math.sin(time*0.012) + 0.18*Math.sin(time*0.031);
    const h = 42 + 18*flick;
    const w = 12 + 6*(1-flick);

    // glow (부드러운 라디얼)
    const g = ctx.createRadialGradient(fx, fy-10, 0, fx, fy-10, 60);
    g.addColorStop(0, `rgba(255,220,140,${0.35+0.2*flick})`);
    g.addColorStop(1, `rgba(0,0,0,0)`);
    ctx.fillStyle = g;
    ctx.beginPath(); ctx.arc(fx, fy-10, 60, 0, Math.PI*2); ctx.fill();

    // 불꽃 레이어 3겹
    function flameLayer(colorA, colorB, scale){
      ctx.fillStyle = colorA;
      ctx.beginPath();
      ctx.moveTo(fx, fy-h*scale);
      ctx.quadraticCurveTo(fx+w*scale*(0.8+0.3*Math.sin(time*0.02)), fy-h*0.55*scale, fx+w*scale, fy);
      ctx.quadraticCurveTo(fx, fy+4, fx-w*scale, fy);
      ctx.quadraticCurveTo(fx-w*scale*(0.8+0.3*Math.cos(time*0.023)), fy-h*0.55*scale, fx, fy-h*scale);
      ctx.closePath();
      ctx.fill();

      // 중심 하이라이트
      ctx.fillStyle = colorB;
      ctx.beginPath();
      ctx.moveTo(fx, fy-h*0.85*scale);
      ctx.quadraticCurveTo(fx+w*0.45*scale, fy-h*0.55*scale, fx+w*0.35*scale, fy-2);
      ctx.quadraticCurveTo(fx, fy+2, fx-w*0.35*scale, fy-2);
      ctx.quadraticCurveTo(fx-w*0.45*scale, fy-h*0.55*scale, fx, fy-h*0.85*scale);
      ctx.closePath();
      ctx.fill();
    }

    flameLayer(`rgba(255,150,60,${0.65})`, `rgba(255,210,130,${0.55})`, 1.00);
    flameLayer(`rgba(255,110,30,${0.55})`, `rgba(255,190,110,${0.45})`, 0.82);
    flameLayer(`rgba(200,70,25,${0.35})`, `rgba(255,170,90,${0.30})`, 0.64);

    // 연기(가늘게 흔들)
    ctx.strokeStyle = `rgba(120,150,190,${0.22})`;
    ctx.lineWidth = 2;
    ctx.beginPath();
    for(let i=0;i<16;i++){
      const yy = fy - 18 - i*10;
      const xx = fx + Math.sin(time*0.008 + i*0.7)*6;
      if(i===0) ctx.moveTo(xx, yy);
      else ctx.lineTo(xx, yy);
    }
    ctx.stroke();

    // 불씨
    if(Math.random()<0.7) spawnSpark(fx, fy-10);
    for(let i=sparks.length-1;i>=0;i--){
      const s = sparks[i];
      s.x += s.vx;
      s.y += s.vy;
      s.life -= 0.02;
      ctx.fillStyle = `rgba(255,200,100,${Math.max(0,s.life)})`;
      ctx.fillRect(s.x, s.y, 2, 2);
      if(s.life<=0) sparks.splice(i,1);
    }
  }

  // ============================================================
  // 3) 웹오디오 “타닥타닥” (mp3 없이 코드 생성)
  // ============================================================
  let audioStarted=false, ac=null, master=null, noiseBuf=null;
  function startAudio(){
    if(audioStarted) return;
    audioStarted=true;
    document.getElementById('hint').style.display='none';

    const AudioContext = window.AudioContext || window.webkitAudioContext;
    ac = new AudioContext();

    master = ac.createGain();
    master.gain.value = 0.16; // 조용하게
    master.connect(ac.destination);

    // 노이즈 버퍼
    const seconds=2.0;
    noiseBuf = ac.createBuffer(1, ac.sampleRate*seconds, ac.sampleRate);
    const ch = noiseBuf.getChannelData(0);
    for(let i=0;i<ch.length;i++) ch[i]=(Math.random()*2-1)*0.55;

    // 기본 러시(불꽃 바탕)
    const base = ac.createBufferSource();
    base.buffer=noiseBuf; base.loop=true;

    const hp = ac.createBiquadFilter();
    hp.type='highpass'; hp.frequency.value=650;

    const bp = ac.createBiquadFilter();
    bp.type='bandpass'; bp.frequency.value=1600; bp.Q.value=0.9;

    const baseGain = ac.createGain();
    baseGain.gain.value=0.28;

    base.connect(hp); hp.connect(bp); bp.connect(baseGain); baseGain.connect(master);
    base.start();

    // 타닥 팝(간헐 버스트)
    function pop(){
      if(!ac) return;
      const now=ac.currentTime;
      const t0=now + (0.09+Math.random()*0.35);

      const src=ac.createBufferSource();
      src.buffer=noiseBuf;

      const f=ac.createBiquadFilter();
      f.type='bandpass'; f.frequency.value=2400+Math.random()*600; f.Q.value=3.5;

      const g=ac.createGain();
      g.gain.setValueAtTime(0.0001,t0);
      const amp=0.02+Math.random()*0.06;
      g.gain.linearRampToValueAtTime(amp,t0+0.004);
      g.gain.exponentialRampToValueAtTime(0.0001,t0+0.06+Math.random()*0.06);

      src.connect(f); f.connect(g); g.connect(master);
      src.start(t0); src.stop(t0+0.25);

      setTimeout(pop, Math.floor((t0-now)*1000));
    }
    pop();
  }

  // iOS Safari: 사용자 제스처로 오디오 시작
  document.addEventListener('pointerdown', startAudio, { once:true });

  // ============================================================
  // 4) 렌더 루프: 원본 이미지 "그대로" + 불꽃만 애니메이션
  // ============================================================
  let ready=false;
  img.onload = () => { ready=true; };

  function frame(time){
    // 배경 검정
    ctx.fillStyle="#000";
    ctx.fillRect(0,0,innerWidth,innerHeight);

    if(ready){
      const rect = containRect(img.naturalWidth, img.naturalHeight, innerWidth, innerHeight);

      // 원본 이미지를 그대로 그리되, 확대시 부드럽지 않게(원하면 픽셀 느낌)
      ctx.imageSmoothingEnabled = true;  // "원본 그대로" 느낌(부드럽게)
      ctx.drawImage(img, rect.x, rect.y, rect.w, rect.h);

      // 불꽃 오버레이
      ctx.imageSmoothingEnabled = true;
      drawFireOverlay(rect, time);
    }

    requestAnimationFrame(frame);
  }
  requestAnimationFrame(frame);

})();
</script>
</body>
</html>
